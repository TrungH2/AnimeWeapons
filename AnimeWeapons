--[[
    ‚ö° HIMONO HUB v4.9 - AUTO JOIN FIX & FPS BOOST ‚ö°
    --------------------------------------------------
    [+] FIX: Auto Join Dungeon/Raid (T·ª± ƒë·ªông v√†o khi c√≥ th√¥ng b√°o)
    [+] FIX: Xung ƒë·ªôt (C√≥ th·ªÉ b·∫≠t c·∫£ Dungeon & Raid c√πng l√∫c ·ªü s·∫£nh)
    [+] ADD: Tab Performance (FPS Boost, White Screen)
    [+] CONFIG: L∆∞u full setting n1, n2...
    --------------------------------------------------
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local CollectionService = game:GetService("CollectionService")
local LocalPlayer = Players.LocalPlayer

-- // --- 1. SETUP & CONFIG --- //

local FOLDER = "HimonoHub"
local PROFILES_FILE = FOLDER .. "/Profiles_v49.json" 
local AUTOLOAD_FILE = FOLDER .. "/AutoLoad_v49.txt"

if not isfolder(FOLDER) then makefolder(FOLDER) end
if not isfile(PROFILES_FILE) then writefile(PROFILES_FILE, "{}") end

local Theme = {
    Bg = Color3.fromRGB(18, 18, 24),
    Side = Color3.fromRGB(25, 25, 35),
    Item = Color3.fromRGB(35, 35, 45),
    Accent = Color3.fromRGB(0, 130, 255),
    Text = Color3.fromRGB(255, 255, 255),
    Green = Color3.fromRGB(0, 220, 100),
    Red = Color3.fromRGB(230, 60, 60),
    Yellow = Color3.fromRGB(255, 200, 0)
}

local Settings = {
    AutoAttack = false, AutoCollect = false, AntiAFK = true,
    FarmSelected = false, FarmRandom = false, SelectedEnemies = {},
    AutoDungeon = false, AutoRaid = false, DungeonMode = "Easy",
    AutoGacha = false, AutoGachaType = "Biju",
    AutoStat = false, SelectedStat = "Mastery",
    AutoEgg = false, TeleportZone = "Zone 1",
    FPS_Reduce = false, FPS_White = false
}

local ActiveLoops = {}
local DungeonState = { Completed = false, StartPos = nil }
local UI_Elements = {}
local CurrentProfile = nil

-- // --- 2. CORE FUNCTIONS --- //

local function SafeFire(remote, ...)
    if remote then remote:FireServer(...) end
end

local function StopLoop(name)
    ActiveLoops[name] = false
end

local function SafeStartLoop(name, func, interval)
    if ActiveLoops[name] then StopLoop(name) end
    ActiveLoops[name] = true
    task.spawn(function()
        while ActiveLoops[name] do
            pcall(func)
            if interval then task.wait(interval) else RunService.Heartbeat:Wait() end
        end
    end)
end

local function Notify(msg, color)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Himono Hub"; Text = msg; Duration = 3;
    })
end

-- // --- 3. GAME LOGIC --- //

-- Check Map
local function IsInDungeon()
    if LocalPlayer:FindFirstChild("InDungeon") then return true end
    if workspace:FindFirstChild("DungeonArea") or workspace:FindFirstChild("RaidArea") then return true end
    
    -- Fallback check b·∫±ng t√™n object xung quanh
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        for _, v in pairs(workspace:GetChildren()) do
            if v:IsA("Model") and (v.Name:find("Dungeon") or v.Name:find("Room") or v.Name:find("Raid")) then
                if v.PrimaryPart and (char.HumanoidRootPart.Position - v.PrimaryPart.Position).Magnitude < 500 then
                    return true
                end
            end
        end
    end
    return false
end

-- T√¨m Qu√°i
local function FindEnemies(range)
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return {} end
    local myPos = char.HumanoidRootPart.Position
    local targets = {}

    local rawList = CollectionService:GetTagged("Enemy")
    if #rawList == 0 then rawList = workspace:GetDescendants() end 

    for _, v in ipairs(rawList) do
        if v:IsA("Model") and v:FindFirstChild("Humanoid") and v:FindFirstChild("Head") then
            local hum = v.Humanoid
            if hum.Health > 0 and not Players:GetPlayerFromCharacter(v) then
                local dist = (myPos - v.Head.Position).Magnitude
                if dist <= range then
                    table.insert(targets, {Model = v, Name = v.Name, Pos = v.Head.Position, Dist = dist})
                end
            end
        end
    end
    table.sort(targets, function(a, b) return a.Dist < b.Dist end)
    return targets
end

-- >>> LOGIC FARM SELECTED (FIXED) <<<
local function Logic_FarmSelected()
    if IsInDungeon() then return end -- Kh√¥ng ch·∫°y selected khi ƒëang dungeon
    if #Settings.SelectedEnemies == 0 then return end
    
    local mobs = FindEnemies(400)
    local target = nil
    for _, m in ipairs(mobs) do
        if table.find(Settings.SelectedEnemies, m.Name) then target = m; break end
    end

    if target then
        local char = LocalPlayer.Character
        local r = ReplicatedStorage:FindFirstChild("RemoteEvent") or ReplicatedStorage:FindFirstChild("Remote")
        if char and r then
            char.HumanoidRootPart.CFrame = CFrame.new(target.Pos + Vector3.new(0, 4, 0))
            SafeFire(r, "Attack", target.Model)
            task.wait(0.05)
            SafeFire(r, "Attack", target.Model)
        end
    end
end

local function Logic_FarmRandom()
    if IsInDungeon() then return end
    local mobs = FindEnemies(400)
    if #mobs > 0 then
        local target = mobs[math.random(1, math.min(3, #mobs))]
        local char = LocalPlayer.Character
        local r = ReplicatedStorage:FindFirstChild("RemoteEvent") or ReplicatedStorage:FindFirstChild("Remote")
        if char and r then
            char.HumanoidRootPart.CFrame = CFrame.new(target.Pos + Vector3.new(0, 4, 0))
            SafeFire(r, "Attack", target.Model)
        end
    end
end

-- >>> LOGIC AUTO JOIN (FIXED LOOP) <<<
local function Logic_AutoJoiner()
    -- Ch·ªâ ch·∫°y khi ƒêANG ·ªû S·∫¢NH (Kh√¥ng trong Dungeon)
    if IsInDungeon() then return end 

    local r = ReplicatedStorage:FindFirstChild("Reply") and ReplicatedStorage.Reply:FindFirstChild("Reliable")
    if not r then return end

    -- ∆Øu ti√™n Dungeon
    if Settings.AutoDungeon then
        local map = {Easy="1", Medium="2", Hard="3"}
        local code = "Dungeon:" .. (map[Settings.DungeonMode] or "1")
        [cite_start]SafeFire(r, "Join Gamemode", {code}) -- [cite: 8]
    end

    -- ∆Øu ti√™n Raid
    if Settings.AutoRaid then
        [cite_start]SafeFire(r, "Join Gamemode", {"Raid:1"}) -- [cite: 7]
    end
    
    -- T·ª± click n√∫t UI n·∫øu c√≥ (Support cho image_d27982.jpg)
    local gui = LocalPlayer:FindFirstChild("PlayerGui")
    if gui then
        -- T√¨m n√∫t Join m√†u xanh trong GUI
        for _, v in pairs(gui:GetDescendants()) do
            if v:IsA("TextButton") and (v.Text == "Join" or v.Name == "Join") then
                -- Gi·∫£ l·∫≠p click
                for _, c in pairs(getconnections(v.MouseButton1Click)) do c:Fire() end
            end
        end
    end
end

-- >>> LOGIC FARM DUNGEON INSTANCE <<<
local function Logic_DungeonFarm()
    if not IsInDungeon() then 
        -- N·∫øu tho√°t ra ngo√†i -> Reset tr·∫°ng th√°i
        DungeonState.Completed = false
        DungeonState.StartPos = nil
        return 
    end

    local char = LocalPlayer.Character
    if not DungeonState.StartPos then DungeonState.StartPos = char.HumanoidRootPart.Position end

    local mobs = FindEnemies(300)
    local r = ReplicatedStorage:FindFirstChild("RemoteEvent") or ReplicatedStorage:FindFirstChild("Remote")

    if #mobs > 0 then
        DungeonState.Completed = false
        local target = mobs[1]
        char.HumanoidRootPart.CFrame = CFrame.new(target.Pos + Vector3.new(0, 3, 0))
        SafeFire(r, "Attack", target.Model)
    else
        if not DungeonState.Completed then
            DungeonState.Completed = true
            task.wait(4) -- ƒê·ª£i nh·∫≠n th∆∞·ªüng
            if DungeonState.StartPos then char.HumanoidRootPart.CFrame = CFrame.new(DungeonState.StartPos) end
        end
    end
end

-- >>> LOGIC EXTRAS <<<
local function Logic_Extras()
    local r = ReplicatedStorage:FindFirstChild("Reply") and ReplicatedStorage.Reply:FindFirstChild("Reliable")
    local rem = ReplicatedStorage:FindFirstChild("RemoteEvent") or ReplicatedStorage:FindFirstChild("Remote")
    
    -- Auto Attack
    if Settings.AutoAttack and not IsInDungeon() then
        local m = FindEnemies(50)
        if m[1] and rem then SafeFire(rem, "Attack", m[1].Model) end
    end
    
    -- Auto Collect
    if Settings.AutoCollect then
        local char = LocalPlayer.Character
        for _,o in pairs(workspace:GetDescendants()) do
            if o.Name:find("Drop") and char and (char.HumanoidRootPart.Position - o.Position).Magnitude < 25 then
                if rem then SafeFire(rem, "Collect", o) end
            end
        end
    end
    
    -- Auto Gacha
    if Settings.AutoGacha and r then
        [cite_start]SafeFire(r, "Crate Roll Start", {Settings.AutoGachaType, true}) -- [cite: 4, 5, 6]
        task.wait(1)
        SafeFire(r, "Crate Roll Stop")
    end
    
    -- Auto Stat
    if Settings.AutoStat and r then
        [cite_start]SafeFire(r, "Distribute Stat Point", {Settings.SelectedStat}) -- [cite: 7]
    end
    
    -- Auto Egg
    if Settings.AutoEgg and r then
        local char = LocalPlayer.Character
        for _,v in pairs(workspace:GetDescendants()) do
            if v:IsA("Model") and (v.Name:find("Egg") or v.Name:find("Crate")) then
                if (char.HumanoidRootPart.Position - v:GetPivot().Position).Magnitude < 15 then
                    SafeFire(r, "Open Star", {"Egg"})
                end
            end
        end
    end
end

-- // --- 4. UI BUILDER --- //

local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "HimonoHubV4.9"

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 550, 0, 450); MainFrame.Position = UDim2.new(0.5, -275, 0.5, -225); MainFrame.BackgroundColor3 = Theme.Bg
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 8)

-- Sidebar
local Sidebar = Instance.new("Frame", MainFrame)
Sidebar.Size = UDim2.new(0, 140, 1, 0); Sidebar.BackgroundColor3 = Theme.Side
Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 8)
local AppTitle = Instance.new("TextLabel", Sidebar); AppTitle.Text = "HIMONO\nHUB v4.9"; AppTitle.Size = UDim2.new(1,0,0,60); AppTitle.BackgroundTransparency=1; AppTitle.TextColor3=Theme.Accent; AppTitle.Font=Enum.Font.GothamBlack; AppTitle.TextSize=20

local TabHolder = Instance.new("ScrollingFrame", Sidebar); TabHolder.Size=UDim2.new(1,0,1,-60); TabHolder.Position=UDim2.new(0,0,0,60); TabHolder.BackgroundTransparency=1; TabHolder.ScrollBarThickness=0
local TabList = Instance.new("UIListLayout", TabHolder); TabList.Padding=UDim.new(0,5); TabList.HorizontalAlignment=Enum.HorizontalAlignment.Center

-- Page Container
local PageHolder = Instance.new("Frame", MainFrame); PageHolder.Size=UDim2.new(1,-150,1,-20); PageHolder.Position=UDim2.new(0,145,0,10); PageHolder.BackgroundTransparency=1

local Tabs, Pages = {}, {}

local function CreateTab(name, icon)
    local btn = Instance.new("TextButton", TabHolder)
    btn.Size = UDim2.new(0.9, 0, 0, 35); btn.BackgroundColor3 = Theme.Bg; btn.Text = (icon or "").."  "..name; btn.TextColor3 = Theme.Text; btn.Font = Enum.Font.GothamBold; btn.TextXAlignment=Enum.TextXAlignment.Left; Instance.new("UICorner", btn).CornerRadius=UDim.new(0,6); Instance.new("UIPadding", btn).PaddingLeft=UDim.new(0,10)
    
    local page = Instance.new("ScrollingFrame", PageHolder); page.Size=UDim2.new(1,0,1,0); page.Visible=false; page.BackgroundTransparency=1; page.ScrollBarThickness=3; Instance.new("UIListLayout", page).Padding=UDim.new(0,5)
    
    Tabs[name] = btn; Pages[name] = page
    btn.MouseButton1Click:Connect(function()
        for _,p in pairs(Pages) do p.Visible=false end
        for _,b in pairs(Tabs) do b.BackgroundColor3=Theme.Bg; b.TextColor3=Theme.Text end
        page.Visible=true; btn.BackgroundColor3=Theme.Accent; btn.TextColor3=Color3.new(1,1,1)
    end)
end

-- Components
local function CreateToggle(page, text, key, cb)
    local f = Instance.new("Frame", Pages[page]); f.Size=UDim2.new(1,0,0,35); f.BackgroundColor3=Theme.Item; Instance.new("UICorner", f)
    local l = Instance.new("TextLabel", f); l.Text=text; l.Size=UDim2.new(0.7,0,1,0); l.Position=UDim2.new(0,10,0,0); l.BackgroundTransparency=1; l.TextColor3=Theme.Text; l.TextXAlignment=Enum.TextXAlignment.Left; l.Font=Enum.Font.Gotham
    local b = Instance.new("TextButton", f); b.Size=UDim2.new(0,50,0,24); b.Position=UDim2.new(1,-60,0.5,-12); Instance.new("UICorner", b)
    
    local function Upd() b.Text=Settings[key] and "ON" or "OFF"; b.BackgroundColor3=Settings[key] and Theme.Green or Theme.Red end
    Upd(); UI_Elements[key] = {Type="Toggle", Func=Upd}
    b.MouseButton1Click:Connect(function() Settings[key]=not Settings[key]; Upd(); if cb then cb(Settings[key]) end end)
end

local function CreateDropdown(page, text, items, key)
    local b = Instance.new("TextButton", Pages[page]); b.Size=UDim2.new(1,0,0,30); b.BackgroundColor3=Theme.Item; b.TextColor3=Theme.Text; Instance.new("UICorner", b); b.Font=Enum.Font.Gotham
    local idx = table.find(items, Settings[key]) or 1
    local function Upd() b.Text=text..": "..items[idx]; Settings[key]=items[idx] end
    Upd(); UI_Elements[key] = {Type="Dropdown", Func=Upd}
    b.MouseButton1Click:Connect(function() idx=idx+1; if idx>#items then idx=1 end; Upd() end)
end

local function CreateButton(page, text, cb, col)
    local b = Instance.new("TextButton", Pages[page]); b.Text=text; b.Size=UDim2.new(1,0,0,30); b.BackgroundColor3=col or Theme.Accent; b.TextColor3=Theme.Text; b.Font=Enum.Font.GothamBold; Instance.new("UICorner", b)
    b.MouseButton1Click:Connect(cb)
end

-- // --- 5. TABS & FEATURES --- //

CreateTab("Main", "üè†"); CreateTab("Farm", "‚öîÔ∏è"); CreateTab("Dungeon", "üè∞"); CreateTab("Gacha", "üé≤"); CreateTab("Extras", "‚ú®"); CreateTab("Perform", "üöÄ"); CreateTab("Config", "üíæ")

-- Main
CreateToggle("Main", "Auto Attack", "AutoAttack")
CreateToggle("Main", "Auto Collect", "AutoCollect")
CreateToggle("Main", "Anti-AFK", "AntiAFK")

-- Farm
CreateToggle("Farm", "Farm Selected", "FarmSelected", function(v) if v then SafeStartLoop("FarmSelected", Logic_FarmSelected, 0.1) else StopLoop("FarmSelected") end end)
CreateButton("Farm", "Refresh List", function()
    for _,v in pairs(Pages["Farm"]:GetChildren()) do if v.Name=="Eb" then v:Destroy() end end
    local u={}; for _,m in ipairs(FindEnemies(500)) do u[m.Name]=true end
    for n,_ in pairs(u) do
        local b=Instance.new("TextButton", Pages["Farm"]); b.Name="Eb"; b.Text=n; b.Size=UDim2.new(1,0,0,25); b.BackgroundColor3=Theme.Item; b.TextColor3=Theme.Text; Instance.new("UICorner", b)
        if table.find(Settings.SelectedEnemies, n) then b.BackgroundColor3=Theme.Green end
        b.MouseButton1Click:Connect(function()
            if table.find(Settings.SelectedEnemies, n) then 
                for i,x in ipairs(Settings.SelectedEnemies) do if x==n then table.remove(Settings.SelectedEnemies, i) end end; b.BackgroundColor3=Theme.Item
            else table.insert(Settings.SelectedEnemies, n); b.BackgroundColor3=Theme.Green end
        end)
    end
end, Theme.Item)
CreateToggle("Farm", "Farm Random", "FarmRandom", function(v) if v then SafeStartLoop("FarmRandom", Logic_FarmRandom, 0.5) else StopLoop("FarmRandom") end end)

-- Dungeon
CreateDropdown("Dungeon", "Mode", {"Easy", "Medium", "Hard"}, "DungeonMode")
CreateToggle("Dungeon", "Auto Dungeon (Join & Farm)", "AutoDungeon") -- B·∫≠t c√°i n√†y n√≥ s·∫Ω t·ª± ch·∫°y Loop Join
CreateToggle("Dungeon", "Auto Raid (Join & Farm)", "AutoRaid") -- B·∫≠t c√°i n√†y n√≥ s·∫Ω t·ª± ch·∫°y Loop Join
CreateButton("Dungeon", "Manual Join Dungeon", function() 
    local r = ReplicatedStorage:FindFirstChild("Reply") and ReplicatedStorage.Reply:FindFirstChild("Reliable")
    local code = "Dungeon:"..(({Easy="1",Medium="2",Hard="3"})[Settings.DungeonMode] or "1")
    SafeFire(r, "Join Gamemode", {code})
end)

-- Gacha & Extras
CreateDropdown("Gacha", "Type", {"Biju", "Haki", "Race", "Fruits"}, "AutoGachaType")
CreateToggle("Gacha", "Auto Roll", "AutoGacha")
CreateDropdown("Extras", "Stat", {"Mastery", "Attack", "Defense"}, "SelectedStat")
CreateToggle("Extras", "Auto Stat", "AutoStat")
CreateDropdown("Extras", "Zone", {"Zone 1", "Zone 2", "Zone 3", "Zone 4"}, "TeleportZone")
CreateButton("Extras", "Teleport", function() 
    local r = ReplicatedStorage:FindFirstChild("Reply") and ReplicatedStorage.Reply:FindFirstChild("Reliable")
    [cite_start]if r then SafeFire(r, "Zone Teleport", {Settings.TeleportZone}) end -- [cite: 1, 2]
end)
CreateToggle("Extras", "Auto Open Egg", "AutoEgg")

-- Performance (FPS Boost)
CreateToggle("Perform", "Reduce Effects (Particles)", "FPS_Reduce", function(v)
    if v then for _,x in pairs(workspace:GetDescendants()) do if x:IsA("ParticleEmitter") or x:IsA("Trail") then x.Enabled=false end end end
end)
CreateToggle("Perform", "White Screen (Best FPS)", "FPS_White", function(v)
    if v then RunService:Set3dRenderingEnabled(false) else RunService:Set3dRenderingEnabled(true) end
end)

-- Config
local CfgName = Instance.new("TextBox", Pages["Config"]); CfgName.Size=UDim2.new(1,0,0,35); CfgName.Text="n1"; CfgName.BackgroundColor3=Theme.Item; CfgName.TextColor3=Theme.Text; Instance.new("UICorner", CfgName)
local CfgList = Instance.new("ScrollingFrame", Pages["Config"]); CfgList.Size=UDim2.new(1,0,0,120); CfgList.BackgroundColor3=Theme.Side; Instance.new("UICorner", CfgList); Instance.new("UIListLayout", CfgList)

local function RefCfg()
    for _,v in pairs(CfgList:GetChildren()) do if v:IsA("TextButton") then v:Destroy() end end
    local d = HttpService:JSONDecode(readfile(PROFILES_FILE))
    for n,_ in pairs(d) do
        local b = Instance.new("TextButton", CfgList); b.Text=n; b.Size=UDim2.new(1,0,0,25); b.BackgroundColor3=(CurrentProfile==n) and Theme.Green or Theme.Item; b.TextColor3=Theme.Text
        b.MouseButton1Click:Connect(function() CurrentProfile=n; CfgName.Text=n; RefCfg() end)
    end
end

local function UpdUI()
    for _,el in pairs(UI_Elements) do el.Func() end
    -- Restart loops based on loaded settings
    if Settings.FarmSelected then SafeStartLoop("FarmSelected", Logic_FarmSelected, 0.1) end
    if Settings.FarmRandom then SafeStartLoop("FarmRandom", Logic_FarmRandom, 0.5) end
end

CreateButton("Config", "Save", function()
    local n = CfgName.Text; if n=="" then return end
    local d = HttpService:JSONDecode(readfile(PROFILES_FILE)); d[n]=Settings; writefile(PROFILES_FILE, HttpService:JSONEncode(d))
    Notify("Saved: "..n, Theme.Green); RefCfg()
end, Theme.Green)
CreateButton("Config", "Load", function()
    if not CurrentProfile then return end
    local d = HttpService:JSONDecode(readfile(PROFILES_FILE)); 
    if d[CurrentProfile] then for k,v in pairs(d[CurrentProfile]) do Settings[k]=v end; UpdUI(); Notify("Loaded: "..CurrentProfile, Theme.Accent) end
end, Theme.Accent)
CreateButton("Config", "Delete", function()
    if not CurrentProfile then return end
    local d = HttpService:JSONDecode(readfile(PROFILES_FILE)); d[CurrentProfile]=nil; writefile(PROFILES_FILE, HttpService:JSONEncode(d)); RefCfg()
end, Theme.Red)
CreateButton("Config", "Set AutoLoad", function()
    if not CurrentProfile then return end; writefile(AUTOLOAD_FILE, CurrentProfile); Notify("AutoLoad: "..CurrentProfile, Theme.Yellow)
end, Theme.Yellow)

-- // --- 6. MASTER LOOP (X·ª¨ L√ù JOIN & EXTRAS) --- //
task.spawn(function()
    while true do
        task.wait(1) -- Check m·ªói 1 gi√¢y
        
        -- Logic Auto Join (Ch·∫°y li√™n t·ª•c ·ªü s·∫£nh)
        Logic_AutoJoiner()
        
        -- Logic Dungeon Farm (Ch·∫°y khi ƒë√£ v√†o dungeon)
        if IsInDungeon() then Logic_DungeonFarm() end
        
        -- Extras
        Logic_Extras()
    end
end)

-- Init
RefCfg()
if isfile(AUTOLOAD_FILE) then
    local n = readfile(AUTOLOAD_FILE)
    local d = HttpService:JSONDecode(readfile(PROFILES_FILE))
    if d[n] then CurrentProfile=n; for k,v in pairs(d[n]) do Settings[k]=v end; UpdUI(); Notify("AutoLoaded: "..n, Theme.Green) end
end

-- Keybind & Mini
local Mini = Instance.new("TextButton", ScreenGui); Mini.Size=UDim2.new(0,50,0,50); Mini.Position=UDim2.new(0.1,0,0.1,0); Mini.Text="H"; Mini.BackgroundColor3=Theme.Accent; Mini.Visible=false; Instance.new("UICorner", Mini).CornerRadius=UDim.new(1,0)
local Close = Instance.new("TextButton", MainFrame); Close.Text="X"; Close.Size=UDim2.new(0,30,0,30); Close.Position=UDim2.new(1,-35,0,5); Close.BackgroundColor3=Theme.Red; Instance.new("UICorner", Close)
local function Tog(v) MainFrame.Visible=v; Mini.Visible=not v end
Close.MouseButton1Click:Connect(function() Tog(false) end); Mini.MouseButton1Click:Connect(function() Tog(true) end)
UserInputService.InputBegan:Connect(function(i,p) if not p and i.KeyCode==Enum.KeyCode.RightControl then Tog(not MainFrame.Visible) end end)

Pages["Main"].Visible=true; Tabs["Main"].BackgroundColor3=Theme.Accent
print("HIMONO HUB v4.9 FIXED LOADED")
